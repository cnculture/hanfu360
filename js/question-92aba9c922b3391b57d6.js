(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["question"],{"0388":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"page-question"},[n("switch-bar"),n("router-view")],1)},a=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("common-header",{staticClass:"c-switch-bar"},[n("div",{staticClass:"tab"},[n("router-link",{staticClass:"item",class:{active:"/question"===t.$route.path},attrs:{replace:!0,exact:!0,to:"/question"}},[t._v("\n      问答\n    ")]),n("router-link",{staticClass:"item",class:{active:"/question/topics"===t.$route.path},attrs:{replace:!0,exact:!0,to:"/question/topics"}},[t._v("\n      专题\n    ")])],1),n("template",{slot:"right"},[n("router-link",{attrs:{to:"/question/search"}},[n("svg",{staticClass:"m-style-svg m-svg-def search-btn"},[n("use",{attrs:{"xlink:href":"#icon-search"}})])])],1)],2)},o=[],r={name:"QuestionSwitchBar"},c=r,l=(n("f0a8"),n("2877")),u=Object(l["a"])(c,i,o,!1,null,"aec2edd6",null);u.options.__file="SwitchBar.vue";var d=u.exports,h={name:"Questions",components:{SwitchBar:d}},f=h,m=(n("7377"),Object(l["a"])(f,s,a,!1,null,"80046bac",null));m.options.__file="QuestionBase.vue";e["default"]=m.exports},"06a6":function(t,e,n){"use strict";var s=n("a02a"),a=n.n(s);a.a},"0980":function(t,e,n){},"0c44":function(t,e,n){},"0ea7":function(t,e,n){"use strict";var s=n("0c44"),a=n.n(s);a.a},"1b1f":function(t,e,n){},"1e67":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-question-search"},[n("search-bar",{model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),n("nav",{staticClass:"questions-nav"},[n("router-link",{attrs:{to:"/question/search",replace:"",exact:"","exact-active-class":"active"}},[t._v("问题")]),n("router-link",{attrs:{to:{path:"/question/search",query:{type:"topic"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("专题")])],1),n("jo-load-more",{ref:"loadmore",staticStyle:{"padding-top":"0.9rem"},attrs:{"auto-load":!1,"show-bottom":t.list.length>0},on:{onRefresh:t.onRefresh,onLoadMore:t.onLoadMore}},["question"===t.type?t._l(t.list,function(t){return n("question-card",{key:t.id,attrs:{question:t}})}):t._l(t.list,function(t){return n("topic-card",{key:t.id,attrs:{topic:t}})})],2),n("div",{directives:[{name:"show",rawName:"v-show",value:t.noData,expression:"noData"}],staticClass:"m-no-find"})],1)},a=[],i=n("8afe"),o=n("2ef0"),r=n.n(o),c=n("3d8d"),l=n("dd6a"),u=n("3fda"),d=n("d728"),h=n("a233"),f=n("365c"),m=n("4260"),v={name:"QuestionSearch",components:{TopicCard:l["a"],QuestionCard:u["a"],SearchBar:c["a"]},data:function(){return{type:"question",keyword:"",offset:0,limit:15,list:[],noData:!1}},computed:{after:function(){var t=this.list.length;return t>0?this.list[t-1].id:0}},watch:{$route:function(t){this.type=t.query.type||"question",this.list=[],this.offset=0,this.noData=!1,this.keyword=""},keyword:function(){this.searchQuestions()}},mounted:function(){this.type=this.$route.query.type||"question"},methods:{searchQuestions:r.a.debounce(function(t,e){this.keyword&&(this.offset=0,"question"===this.type?this.queryQuestions(e):this.queryTopics(e))},600),queryQuestions:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m["d"],n={offset:this.offset,limit:this.limit,type:"all",subject:this.keyword};Object(d["b"])(n).then(function(n){var s=n.data;0===t.offset?t.list=s:t.list=Object(i["a"])(t.list).concat(Object(i["a"])(s)),t.noData=!t.list.length,e(s.length<f["b"])})},queryTopics:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m["d"],n={offset:this.offset,limit:this.limit,name:this.keyword};Object(h["d"])(n).then(function(n){var s=n.data;0===t.offset?t.list=s:t.list=Object(i["a"])(t.list).concat(Object(i["a"])(s)),t.noData=!t.list.length,e(s.length<f["b"])})},onRefresh:function(t){this.offset=0,this.searchQuestions(null,t)},onLoadMore:function(t){this.offset=this.list.length,this.searchQuestions(null,t)}}},p=v,w=(n("c54a"),n("561f"),n("2877")),_=Object(w["a"])(p,s,a,!1,null,"4b616e7f",null);_.options.__file="QuestionSearch.vue";e["default"]=_.exports},2840:function(t,e,n){"use strict";var s=n("b567"),a=n.n(s);a.a},"358c":function(t,e,n){},"3fda":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"c-question-card"},[n("router-link",{staticClass:"title",attrs:{to:"/questions/"+t.question.id,tag:"h3"}},[t._v("\n    "+t._s(t.question.subject)+"\n    "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.question.excellent&&!t.noExcellent,expression:"question.excellent && !noExcellent"}],staticClass:"shang-i"},[t._v("精")])]),t.firstImageStyle?n("router-link",{staticClass:"image",style:t.firstImageStyle,attrs:{to:"/questions/"+t.question.id,tag:"div"}}):t._e(),Object.keys(t.answer).length?n("question-list-answer-card",{attrs:{answer:t.answer}}):t._e(),n("router-link",{staticClass:"button",attrs:{to:"/questions/"+t.question.id,tag:"div"}},[n("span",{staticClass:"button-style1"},[t._v(t._s(t.question.watchers_count))]),t._v("\n    关注\n    "),n("span",{staticClass:"dot"},[t._v("·")]),n("span",{staticClass:"button-style1"},[t._v(t._s(t.question.answers_count))]),t._v("\n    回答\n    "),n("span",{staticClass:"dot"},[t._v("·")]),n("span",{directives:[{name:"show",rawName:"v-show",value:t.question.amount,expression:"question.amount"}],staticClass:"shang"},[n("span",[t._v("赏")]),t._v(" "+t._s(t.question.amount)+"\n    ")]),n("span",{staticClass:"button-time"},[t._v(t._s(t._f("time2tips")(t.question.updated_at)))])])],1)},a=[],i=(n("4917"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.answer?n("div",{staticClass:"module-question-list-answer-card",on:{click:t.gotoQuestionDetail}},[n("avatar",{attrs:{anonymity:t.anonymity,user:t.user,size:"nano"}}),t._v("\n  "+t._s(t.showUsername)+" "),t.isMine&&t.anonymity?n("span",{staticClass:"gray"},[t._v("(匿名)")]):t._e(),t._v("："+t._s(t.body)+"\n")],1):n("div",{staticClass:"empty"})}),o=[],r=(n("a481"),n("7f7f"),n("c93e")),c=n("6bde"),l=n("2f62"),u={name:"QuestionListAnswerCard",props:{answer:{type:[Object],default:null,validator:function(t){return!t||"object"===Object(c["a"])(t)}}},computed:Object(r["a"])({},Object(l["d"])({CURRENTUSER:"CURRENTUSER"}),{anonymity:function(){var t=this.answer.anonymity;return!!t},isMine:function(){return this.user.id===this.CURRENTUSER.id},user:function(){var t=this.answer.user;return t||{}},showUsername:function(){return!this.isMine&&this.anonymity?"匿名用户":this.user.name},body:function(){var t=this.answer.body||"";return t.replace(/@!\[image]\(\d+\)/g,"[图片]")}}),methods:{gotoQuestionDetail:function(){var t=this.answer.question_id;this.$router.push("/questions/".concat(t))}}},d=u,h=(n("dc6d"),n("2877")),f=Object(h["a"])(d,i,o,!1,null,"9686d5bc",null);f.options.__file="QuestionListAnswerCard.vue";var m=f.exports,v=n("365c"),p=n("1038"),w={name:"QuestionCard",components:{QuestionListAnswerCard:m},props:{question:{type:Object,required:!0},noExcellent:{type:Boolean,default:!1}},computed:{answer:function(){var t=this.question.answer;return t||{}},body:function(){return Object(p["syntaxTextAndImage"])(this.question.body)},firstImageStyle:function(){var t=this.answer.body||"",e=t.match(/@!\[image]\((\d+)\)/);return!!e&&"background-image: url(".concat(v["a"],"/files/").concat(e[1],")")}}},_=w,b=(n("6cf4"),Object(h["a"])(_,s,a,!1,null,"412cee42",null));b.options.__file="QuestionCard.vue";e["a"]=b.exports},4551:function(t,e,n){"use strict";var s=n("790c"),a=n.n(s);a.a},"561f":function(t,e,n){"use strict";var s=n("358c"),a=n.n(s);a.a},"59f3":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-question-detail"},[n("common-header",[t._v("问题详情")]),n("div",{staticClass:"container"},[n("jo-load-more",{ref:"loadmore",on:{onRefresh:t.handleRefreshAnswers,onLoadMore:t.handleLoadMoreAnswers}},[n("div",{staticClass:"main"},[n("div",{staticClass:"main-topics"},t._l(t.topics,function(e){return n("router-link",{key:e.id,staticClass:"label",attrs:{to:"/question-topics/"+e.id}},[t._v("\n            "+t._s(e.name)+"\n          ")])})),n("h3",{staticClass:"main-title"},[t._v(t._s(t.question.subject))]),n("div",{staticClass:"markdown-body",domProps:{innerHTML:t._s(t.htmlBody)}}),n("div",{staticClass:"main-watch"},[n("div",{staticClass:"main-watch-count"},[n("span",{staticClass:"follow-count"},[t._v(t._s(t.question.watchers_count)+" 关注")]),n("span",{directives:[{name:"show",rawName:"v-show",value:t.question.amount,expression:"question.amount"}]},[n("span",[t._v("·")]),n("span",{staticClass:"shang"},[n("span",[t._v("赏")]),t._v("\n                "+t._s(t.question.amount)+"\n              ")])])]),t.question.watched?n("button",{staticClass:"main-watch-follow active",on:{click:t.handleUnwatch}},[n("svg",{staticClass:"m-style-svg follow-btn"},[n("use",{attrs:{"xlink:href":"#icon-yes"}})]),t._v("\n            已关注\n          ")]):n("button",{staticClass:"main-watch-follow",on:{click:t.handleWatch}},[n("svg",{staticClass:"m-style-svg follow-btn"},[n("use",{attrs:{"xlink:href":"#icon-plus"}})]),t._v("\n            关注\n          ")])])]),n("div",{staticClass:"main-button"},[n("div",{staticClass:"button"},[n("svg",{staticClass:"main-button-icon",attrs:{fill:"#666"}},[n("use",{attrs:{"xlink:href":"#icon-question-"+(t.question.amount?"reward":"unreward")}})]),t.invitations.length?[t._v("已邀请悬赏")]:[t._v(t._s(t.question.amount?"已":"未")+"设置悬赏")]],2),t.question.my_answer?n("div",{staticClass:"button",on:{click:t.gotoMyAnswer}},[t._v("\n          查看回答\n        ")]):n("div",{staticClass:"button",on:{click:t.addAnswer}},[n("svg",{staticClass:"main-button-icon",attrs:{fill:"#666"}},[n("use",{attrs:{"xlink:href":"#icon-question-add"}})]),t._v("\n          添加回答\n        ")])]),n("div",{staticClass:"answers-tool"},[n("div",[t._v(t._s(t.question.answers_count)+"个回答")]),n("button",{on:{click:t.showOrderPopup}},[t._v("\n          "+t._s(t.answersTimeOrder?"时间排序":"默认排序")+"\n          "),n("svg",{staticClass:"icon",attrs:{fill:"#999"}},[n("use",{attrs:{"xlink:href":"#icon-list"}})])])]),t._l(t.answers,function(t){return n("question-answer-item",{key:t.id,attrs:{answer:t}})})],2)],1)],1)},a=[],i=n("8afe"),o=n("1038"),r=n("d728"),c=n("cac4"),l=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-question-answer-item",on:{click:t.viewDetail}},[n("div",{staticClass:"main"},[n("div",{staticClass:"avatar",on:{click:function(e){return e.stopPropagation(),t.viewUser(e)}}},[n("avatar",{attrs:{anonymity:t.anonymity,user:t.user}})],1),n("div",{staticClass:"info"},[n("h3",{staticClass:"main-header"},[n("span",{staticClass:"name",class:{adoption:t.answer.adoption,invited:t.answer.invited}},[t.anonymity?t.isMine?[t._v(t._s(t.user.name)+" "),n("span",{staticClass:"gray"},[t._v("(匿名)")])]:[t._v("匿名用户")]:[t._v(t._s(t.user.name))]],2),n("span",{staticClass:"time"},[t._v(t._s(t._f("time2tips")(t.answer.created_at)))])]),n("div",{staticClass:"main-body"},[t._v(t._s(t.body))])])]),n("div",{staticClass:"main-button"},[n("span",{on:{click:function(e){return e.stopPropagation(),t.handleLikeTarget(e)}}},[n("svg",{staticClass:"icon"},[n("use",{attrs:{"xlink:href":t.answer.liked?"#icon-like":"#icon-unlike"}})]),t._v("\n      "+t._s(t._f("formatNum")(t.answer.likes_count))+"\n    ")]),n("span",[n("svg",{staticClass:"icon"},[n("use",{attrs:{"xlink:href":"#icon-comment"}})]),t._v("\n      "+t._s(t._f("formatNum")(t.answer.comments_count))+"\n    ")])])])},u=[],d=(n("a481"),{name:"QuestionAnswerItem",props:{answer:{type:Object,required:!0}},data:function(){return{likeTargetHanding:!1}},computed:{anonymity:function(){var t=this.answer.anonymity;return!!t},user:function(){var t=this.answer.user,e=void 0===t?{}:t;return e},body:function(){var t=this.answer.body||"";return t.replace(/@!\[image]\(\d+\)/g,"[图片]")},isMine:function(){return this.user.id===this.$store.state.CURRENTUSER.id}},methods:{handleLike:function(){var t=this;Object(c["f"])(this.answer.id).then(function(){t.likeTargetHanding=!1,t.answer.liked=!0,t.answer.likes_count+=1}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.likeTargetHanding=!1,t.$Message.error(s)})},handleUnlike:function(){var t=this;Object(c["l"])(this.answer.id).then(function(){t.likeTargetHanding=!1,t.answer.liked=!1,t.answer.likes_count-=1}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.likeTargetHanding=!1,t.$Message.error(s)})},handleLikeTarget:function(){this.likeTargetHanding?this.$Message.warning("正在执行，请勿重复点击!"):this.answer.liked?this.handleUnlike():this.handleLike()},viewDetail:function(){this.$router.push("/questions/".concat(this.answer.question_id,"/answers/").concat(this.answer.id))},viewUser:function(){this.user.id&&this.$router.push("/users/".concat(this.user.id))}}}),h=d,f=(n("65cb"),n("2877")),m=Object(f["a"])(h,l,u,!1,null,"1ff9aa7c",null);m.options.__file="QuestionAnswerItem.vue";var v=m.exports,p={name:"QuestionDetail",components:{QuestionAnswerItem:v},data:function(){return{question:{},answersTimeOrder:!1,answers:[]}},computed:{logedUser:function(){var t=this.$store.state.CURRENTUSER;return t},editer:function(){return!1},topics:function(){return this.question.topics||[]},htmlBody:function(){var t=this.question.body,e=void 0===t?"":t;return Object(o["render"])(e)},answerRequestMethod:function(){return this.answersTimeOrder?c["h"]:c["g"]},invitations:function(){return this.question.invitations||[]},adoptionAnswers:function(){return this.question.adoption_answers||[]},invitationAnswers:function(){return this.question.invitation_answers||[]}},watch:{answersTimeOrder:function(t,e){t.path===e.path&&(this.answers=[],this.$refs.loadmore.beforeRefresh())}},mounted:function(){this.$refs.loadmore.beforeRefresh()},methods:{refreshAnswer:function(){var t=this;this.answerRequestMethod(this.$route.params.id).then(function(e){var n,s,a=e.data;t.$refs.loadmore.afterRefresh(a.length<15),t.answers=a,(n=t.answers).unshift.apply(n,Object(i["a"])(t.adoptionAnswers)),(s=t.answers).unshift.apply(s,Object(i["a"])(t.invitationAnswers))}).catch(function(e){return t.$refs.loadmore.afterRefresh(),Promise.reject(e)})},handleRefreshAnswers:function(){var t=this;r["c"](this.$route.params.id).then(function(e){var n=e.data;t.question=n,t.refreshAnswer()}).catch(function(e){return t.$refs.loadmore.afterRefresh(),Promise.reject(e)})},handleLoadMoreAnswers:function(){var t=this;this.answers.length&&this.answerRequestMethod(this.$route.params.id,this.answers.length).then(function(e){var n=e.data;t.$refs.loadmore.afterLoadMore(n.length<15),t.answers=Object(i["a"])(t.answers).concat(Object(i["a"])(n))}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.$refs.loadmore.afterLoadMore(!0),t.$Message.error(s)})},handleWatch:function(){var t=this;r["e"](this.$route.params.id).then(function(){t.question.watched=!0,t.question.watchers_count+=1}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.$Message.error(s)})},handleUnwatch:function(){var t=this;r["d"](this.$route.params.id).then(function(){t.question.watched=!1,t.question.watchers_count-=1}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.$Message.error(s)})},addAnswer:function(){this.$router.push({path:"/question/".concat(this.question.id,"/answers/add")})},gotoMyAnswer:function(){var t=this.question.my_answer.id,e=void 0===t?"":t;this.$router.push({path:"/questions/".concat(this.question.id,"/answers/").concat(e)})},showOrderPopup:function(){var t=this,e=[{text:"默认排序",method:function(){t.answersTimeOrder=!1}},{text:"按时间排序",method:function(){t.answersTimeOrder=!0}}];this.$bus.$emit("actionSheet",e,"取消")}}},w=p,_=(n("9fcb"),Object(f["a"])(w,s,a,!1,null,"fedb4558",null));_.options.__file="QuestionDetail.vue";e["default"]=_.exports},"5eab":function(t,e,n){},"607e":function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",[n("div",{staticClass:"c-article-card"},[n("div",{staticClass:"m-box-model m-art-card"},[n("header",{ref:"head",staticClass:"m-box-model m-pos-f m-head-top"},[t._t("head",[n("common-header",[t._v("资讯详情")])])],2),t.loading?n("div",{staticClass:"m-spinner pos-f"},[n("div"),n("div")]):t._e(),n("main",{staticClass:"m-box-model"},[t._t("default")],2),t.canOprate?n("footer",{ref:"foot",staticClass:"m-pos-f"},[t._t("foot",[n("a",{staticClass:"m-box-model m-aln-center",on:{click:function(e){return e.preventDefault(),t.handelLike(e)}}},[n("svg",{staticClass:"m-style-svg m-svg-def"},[n("use",{attrs:{"xlink:href":t.liked?"#icon-like":"#icon-unlike"}})]),n("span",[t._v("喜欢")])]),n("a",{staticClass:"m-box-model m-aln-center",on:{click:function(e){return e.preventDefault(),t.handelComment(e)}}},[n("svg",{staticClass:"m-style-svg m-svg-def"},[n("use",{attrs:{"xlink:href":"#icon-comment"}})]),n("span",[t._v("评论")])]),n("a",{staticClass:"m-box-model m-aln-center",on:{click:function(e){return e.preventDefault(),t.handelShare(e)}}},[n("svg",{staticClass:"m-style-svg m-svg-def"},[n("use",{attrs:{"xlink:href":"#icon-share"}})]),n("span",[t._v("分享")])]),n("a",{staticClass:"m-box-model m-aln-center",on:{click:function(e){return e.preventDefault(),t.handelMore(e)}}},[n("svg",{staticClass:"m-style-svg m-svg-def"},[n("use",{attrs:{"xlink:href":"#icon-more"}})]),n("span",[t._v("更多")])])])],2):t._e()])])])},a=[],i=n("7b46"),o=n.n(i),r={name:"ArticleCard",props:{loading:{type:Boolean,default:!0},liked:{type:Boolean,default:!1},canOprate:{type:Boolean,default:!0}},data:function(){return{headroom:null,footroom:null}},computed:{isWechat:function(){return this.$store.state.BROWSER.isWechat}},watch:{canOprate:function(t){var e=this;t&&this.$nextTick(function(){e.footroot||(e.footroom=new o.a(e.$refs.foot,{tolerance:5,offset:50,classes:{initial:"headroom-foot",pinned:"headroom--footShow",unpinned:"headroom--footHide"}})),e.footroom.init()})}},mounted:function(){var t=this;this.headroom=new o.a(this.$refs.head,{tolerance:5,offset:50,classes:{initial:"headroom-head",pinned:"headroom--headShow",unpinned:"headroom--headHide"}}),this.headroom.init(),this.canOprate&&this.$nextTick(function(){t.footroom=new o.a(t.$refs.foot,{tolerance:5,offset:50,classes:{initial:"headroom-foot",pinned:"headroom--footShow",unpinned:"headroom--footHide"}}),t.footroom.init()})},methods:{handelLike:function(){this.$emit("on-like")},handelComment:function(){this.$emit("on-comment")},handelShare:function(){this.$emit("on-share")},handelMore:function(){this.$emit("on-more")},goback:function(){this.$router.go(-1)}}},c=r,l=(n("dcef"),n("2877")),u=Object(l["a"])(c,s,a,!1,null,"2a7162ac",null);u.options.__file="ArticleCard.vue";e["a"]=u.exports},"632c":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-answer-add"},[n("common-header",{staticClass:"header"},[t._v("\n    添加回答\n    "),n("span",{staticClass:"post-btn",class:{disabled:t.disabled},attrs:{slot:"right"},on:{click:t.onPost},slot:"right"},[t._v("发布")])]),n("main",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],attrs:{placeholder:"请输入你的回答"},domProps:{value:t.content},on:{input:function(e){e.target.composing||(t.content=e.target.value)}}})]),n("footer",[n("v-switch",{staticClass:"m-box m-bt1 m-bb1 m-lim-width m-pinned-row",attrs:{type:"checkbox"},model:{value:t.anonymity,callback:function(e){t.anonymity=e},expression:"anonymity"}},[t._t("default",[t._v("匿名回答")])],2)],1)],1)},a=[],i=(n("a481"),n("96cf"),n("3040")),o={name:"AnswerAdd",data:function(){return{content:"",anonymity:!1}},computed:{questionId:function(){return this.$route.params.questionId||0},disabled:function(){return!this.content}},methods:{onPost:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.disabled){t.next=2;break}return t.abrupt("return");case 2:return e={questionId:this.questionId,content:this.content.replace(/\n/g,"\n\n"),anonymity:this.anonymity?1:0},t.next=5,this.$store.dispatch("question/postAnswer",e);case 5:this.goBack();case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}},r=o,c=(n("a30d"),n("2877")),l=Object(c["a"])(r,s,a,!1,null,"6de6fb95",null);l.options.__file="AnswerAdd.vue";e["default"]=l.exports},"64af":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-topic-detail"},[n("common-header",[t._v(t._s(t.topic.name||"专题详情"))]),n("main",[n("div",{staticClass:"topic"},[n("img",{staticClass:"avatar",attrs:{src:t.avatar}}),n("div",{staticClass:"title"},[n("h3",{staticClass:"topic-name m-text-cut"},[t._v(t._s(t.topic.name))]),n("div",{staticClass:"label"},[n("span",[t._v(t._s(t.topic.follows_count))]),t._v(" 关注\n          ·\n          "),n("span",[t._v(t._s(t.topic.questions_count))]),t._v(" 问题\n        ")])]),t.topic.has_follow?n("button",{staticClass:"follow active",on:{click:function(e){t.handleUnfollow(t.topic)}}},[n("svg",{staticClass:"m-style-svg m-svg-small"},[n("use",{attrs:{"xlink:href":"#icon-yes"}})]),t._v("已关注\n      ")]):n("button",{staticClass:"follow",on:{click:function(e){t.handleFollow(t.topic)}}},[n("svg",{staticClass:"m-style-svg m-svg-small"},[n("use",{attrs:{"xlink:href":"#icon-plus"}})]),t._v("关注\n      ")])]),n("div",{staticClass:"topic-desc"},[t._v("专题简介："+t._s(t.topic.description))]),n("div",{staticClass:"experts"},[n("span",[t._v(t._s(t.topic.experts_count)+"位相关专家")]),n("div",t._l(t.topic.experts,function(e,s){return n("avatar",{key:e.id,staticClass:"experts-user",style:[{zIndex:t.topic.experts.length-s}],attrs:{user:e,size:"tiny"}})}))]),n("nav",{ref:"types",staticClass:"types"},[n("router-link",{attrs:{to:{path:"/question-topics/"+t.id},replace:"",exact:"","exact-active-class":"active"}},[t._v("热门")]),n("router-link",{attrs:{to:{path:"/question-topics/"+t.id,query:{type:"excellent"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("精选")]),n("router-link",{attrs:{to:{path:"/question-topics/"+t.id,query:{type:"reward"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("悬赏")]),n("router-link",{attrs:{to:{path:"/question-topics/"+t.id,query:{type:"new"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("最新")]),n("router-link",{attrs:{to:{path:"/question-topics/"+t.id,query:{type:"all"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("全部")])],1),n("jo-load-more",{ref:"loadmore",staticClass:"questions",on:{onRefresh:t.handleRefresh,onLoadMore:t.handleLoadQuestions}},t._l(t.questions,function(t){return n("question-card",{key:t.id,attrs:{question:t}})}))],1)],1)},a=[],i=(n("ac6a"),n("8afe")),o=n("3fda"),r=n("a233"),c={name:"TopicDetail",components:{QuestionCard:o["a"]},data:function(){return{topic:{},loading:!0,questions:[],typeNavOffsetTop:0}},computed:{id:function(){return this.$route.params.id},type:function(){var t=this.$route.query.type,e=void 0===t?"hot":t;return e},avatar:function(){var t=this.topic.avatar||{};return t.url||null}},watch:{$route:function(t,e){t.path===e.path&&t.query.type!==e.query.type&&(this.questions=[],this.$refs.loadmore.beforeRefresh())}},mounted:function(){this.typeNavOffsetTop=this.$refs.types.offsetTop,document.addEventListener("scroll",this.handleScrolling)},methods:{handleRefresh:function(){var t=this;r["f"](this.id).then(function(e){var n=e.data;t.loading=!1,t.topic=n,t.handleRefreshQuestions()}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.loading=!0,t.$refs.loadmore.afterRefresh(!1),t.$Message.error(s)})},handleRefreshQuestions:function(){var t=this,e=0,n=15;r["e"](this.id,this.type,e,n).then(function(e){var s=e.data;t.questions=s,t.$refs.loadmore.afterRefresh(s.length<n)}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.$refs.loadmore.afterRefresh(!0),t.$Message.error(s)})},handleLoadQuestions:function(){var t=this,e=this.questions.length,n=15;r["e"](this.id,this.type,e,n).then(function(e){var s=e.data;t.questions=Object(i["a"])(t.questions).concat(Object(i["a"])(s)),t.$refs.loadmore.afterLoadMore(s.length<n)}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.$refs.loadmore.afterLoadMore(!0),t.$Message.error(s)})},handleScrolling:function(){},handleFollow:function(t){var e=this;r["b"](t.id).then(function(){t.has_follow=!0,e.follows_count+=1}).catch(function(t){var n=t.response;n=void 0===n?{}:n;var s=n.data;e.$Message.error(s)})},handleUnfollow:function(t){var e=this;r["g"](t.id).then(function(){if(t.has_follow=!1,t.follows_count-=1,"follow"===e.type){var n=[];e.topics.forEach(function(e){e.id!==t.id&&n.push(e)}),e.topics=n}}).catch(function(t){var n=t.response;n=void 0===n?{}:n;var s=n.data;e.$Message.error(s)})}}},l=c,u=(n("06a6"),n("2877")),d=Object(u["a"])(l,s,a,!1,null,"07000575",null);d.options.__file="TopicDetail.vue";e["default"]=d.exports},"65cb":function(t,e,n){"use strict";var s=n("f881"),a=n.n(s);a.a},"6a6b":function(t,e,n){},"6bb8":function(t,e,n){},"6cf4":function(t,e,n){"use strict";var s=n("5eab"),a=n.n(s);a.a},7377:function(t,e,n){"use strict";var s=n("1b1f"),a=n.n(s);a.a},"76eb":function(t,e,n){},"790c":function(t,e,n){},8270:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-art-rewards"},[n("common-header",[t._v("打赏列表")]),n("main",[n("jo-load-more",{ref:"loadmore",attrs:{"auto-load":!1},on:{onRefresh:t.onRefresh,onLoadMore:t.onLoadMore}},t._l(t.rewards,function(e,s){var a=e.user,i=e.id,o=e.created_at;return n("section",{key:"reward-"+i+"-"+s,staticClass:"m-box m-aln-center m-justify-bet m-art-reward-item m-bb1 m-main"},[n("avatar",{attrs:{user:a,size:"tiny"}}),n("h2",{staticClass:"m-box m-flex-grow1 m-flex-shrink1 m-text-cut"},[n("b",[t._v(t._s(a.name))]),t._v("打赏了"+t._s(t.typeMap[t.type]))]),n("time",{staticClass:"m-flex-grow0 m-flex-shrink0",attrs:{datetime:o}},[t._v(t._s(t._f("time2tips")(o)))])],1)}))],1)],1)},a=[],i=n("8afe"),o={name:"ArticleRewards",data:function(){return{rewards:[],typeMap:{feed:"动态",news:"资讯",post:"帖子",answer:"回答"}}},computed:{type:function(){return this.$route.meta.type},article:function(){return this.$route.params.article},url:function(){switch(this.type){case"feed":return"/feeds/".concat(this.article,"/rewards");case"news":return"/news/".concat(this.article,"/rewards");case"post":return"/plus-group/group-posts/".concat(this.article,"/rewards");case"answer":return"/question-answers/".concat(this.article,"/rewarders")}}},mounted:function(){this.$refs.loadmore.beforeRefresh()},methods:{onRefresh:function(t){var e=this;this.$http.get(this.url,{params:{limit:15}}).then(function(n){var s=n.data,a=void 0===s?[]:s;e.rewards=a,t(a.length<15)}).catch(function(){t(!0)})},onLoadMore:function(t){var e=this;this.$http.get(this.url,{params:{limit:15,offset:this.rewards.length}}).then(function(n){var s=n.data,a=void 0===s?[]:s;e.rewards=Object(i["a"])(e.rewards).concat(Object(i["a"])(a)),t(a.length<15)}).catch(function(){t(!0)})}}},r=o,c=(n("4551"),n("2877")),l=Object(c["a"])(r,s,a,!1,null,"123d7b16",null);l.options.__file="ArticleRewards.vue";e["default"]=l.exports},"82c2":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-art-likes"},[n("common-header",[t._v("点赞列表")]),n("main",[n("jo-load-more",{ref:"loadmore",attrs:{"auto-load":!1},on:{onRefresh:t.onRefresh,onLoadMore:t.onLoadMore}},t._l(t.likes,function(t,e){var s=t.user,a=t.id;return n("user-item",{key:"likes-"+a+"-"+s.id+"-"+e,attrs:{user:s}})}))],1)],1)},a=[],i=n("8afe"),o=n("86e8"),r={name:"ArticleLikes",components:{UserItem:o["a"]},data:function(){return{likes:[],maxId:0}},computed:{type:function(){return this.$route.meta.type},article:function(){return this.$route.params.article},url:function(){switch(this.type){case"feed":return"/feeds/".concat(this.article,"/likes");case"news":return"/news/".concat(this.article,"/likes");case"post":return"/plus-group/group-posts/".concat(this.article,"/likes");case"answer":return"/question-answers/".concat(this.article,"/likes")}}},mounted:function(){this.$refs.loadmore.beforeRefresh()},methods:{goBack:function(){window.history.length<=1?this.$router.push("/feeds/".concat(this.article)):this.$router.go(-1)},onRefresh:function(t){var e=this;this.$http.get(this.url,{params:{limit:15}}).then(function(n){var s=n.data,a=void 0===s?[]:s;e.likes=a,a.length>0&&(e.maxId=a[a.length-1].id),t(a.length<15)})},onLoadMore:function(t){var e=this;this.$http.get(this.url,{params:{limit:15,after:this.maxId}}).then(function(n){var s=n.data,a=void 0===s?[]:s;e.likes=Object(i["a"])(e.likes).concat(Object(i["a"])(a)),a.length>0&&(e.maxId=a[a.length-1].id),t(a.length<15)})}}},c=r,l=n("2877"),u=Object(l["a"])(c,s,a,!1,null,null,null);u.options.__file="ArticleLikes.vue";e["default"]=u.exports},"89df":function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"module-questions-topics"},[n("nav",{staticClass:"nav"},[n("router-link",{attrs:{to:"/question/topics",replace:"",exact:"","exact-active-class":"active"}},[t._v("全部专题")]),n("router-link",{attrs:{to:{path:"/question/topics",query:{type:"follow"}},replace:"",exact:"","exact-active-class":"active"}},[t._v("我关注的")])],1),n("load-more",{ref:"LoadQuestionTopicsContainer",attrs:{"on-refresh":t.handleRefresh,"on-load-more":t.handleLoadMore}},t._l(t.topics,function(e){return n("topic-card",{key:e.id,attrs:{topic:e,type:t.type},on:{follow:t.handleFollow,unfollow:t.handleUnfollow}})}))],1)},a=[],i=(n("ac6a"),n("8afe")),o=n("dd6a"),r=n("a233"),c={name:"TopicList",components:{TopicCard:o["a"]},data:function(){return{topics:[]}},computed:{type:function(){var t=this.$route.query.type,e=void 0===t?"hot":t;return e},loadContainer:function(){return this.$refs.LoadQuestionTopicsContainer},user:function(){var t=this.$store.state.CURRENTUSER;return t}},watch:{type:function(){this.topics=[],this.loadContainer.beforeRefresh()}},mounted:function(){this.loadContainer.beforeRefresh()},methods:{handleRefresh:function(){"follow"!==this.type?this.handleRefreshByAll():this.handleRefreshByFollow()},handleRefreshByAll:function(){var t=this,e=0,n=15;r["a"](e,n).then(function(e){var s=e.data;t.topics=s,t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(s.length<n)}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.$Message.error(s),t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(!0)})},handleRefreshByFollow:function(){var t=this,e=0,n=15;r["c"](e,n).then(function(e){var s=e.data;t.topics=s,t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(s.length<n)}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.$Message.error(s),t.loadContainer.topEnd(!1),t.loadContainer.bottomEnd(!0)})},handleLoadMore:function(){"follow"!==this.type?this.handleLoadMoreByAll():this.handleLoadMoreByFollow()},handleLoadMoreByAll:function(){var t=this,e=this.topics.length,n=15;r["a"](e,n).then(function(e){var s=e.data;t.topics=Object(i["a"])(t.topics).concat(Object(i["a"])(s)),t.loadContainer.bottomEnd(s.length<n)}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.loadContainer.bottomEnd(!0),t.$Message.error(s)})},handleLoadMoreByFollow:function(){var t=this,e=this.topisc[this.topics.length].id,n=15;r["c"](e,n).then(function(e){var s=e.data;t.topics=Object(i["a"])(t.topics).concat(Object(i["a"])(s)),t.loadContainer.bottomEnd(s.length<n)}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.loadContainer.bottomEnd(!0),t.$Message.error(s)})},handleFollow:function(t){var e=this;r["b"](t.id).then(function(){t.has_follow=!0,e.follows_count+=1})},handleUnfollow:function(t){var e=this;r["g"](t.id).then(function(){if(t.has_follow=!1,t.follows_count-=1,"follow"===e.type){var n=[];e.topics.forEach(function(e){e.id!==t.id&&n.push(e)}),e.topics=n}}).catch(function(t){var n=t.response;n=void 0===n?{}:n;var s=n.data;e.$Message.error(s)})}}},l=c,u=(n("be53"),n("2877")),d=Object(u["a"])(l,s,a,!1,null,"1fce516b",null);d.options.__file="TopicList.vue";e["default"]=d.exports},"9fcb":function(t,e,n){"use strict";var s=n("d73d"),a=n.n(s);a.a},a02a:function(t,e,n){},a30d:function(t,e,n){"use strict";var s=n("76eb"),a=n.n(s);a.a},a52a:function(t,e,n){},ae61:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-lim-width m-art-comment"},[n("div",{staticClass:"m-box m-art-comment-wrap"},[n("avatar",{attrs:{user:t.user}}),n("section",{staticClass:"m-box-model m-flex-grow1 m-flex-shrink1 m-art-comment-body"},[n("header",{staticClass:"m-box m-aln-center m-justify-bet m-art-comment-usr"},[n("h4",{staticClass:"m-flex-grow1 m-flex-shrink1"},[t._v(t._s(t.user.name))]),n("div",{staticClass:"m-box m-aln-center"},[t.pinned?n("span",{staticClass:"m-art-comment-icon-top"},[t._v("置顶")]):t._e(),n("span",[t._v(t._s(t._f("time2tips")(t.time)))])])]),n("article",{staticClass:"m-text-box m-art-comment-con",class:{maxh:!t.isShowAll},on:{click:t.handelClick}},[t.replyUser?[n("span",{staticClass:"m-art-comment-rep"},[t._v("\n            回复"),n("router-link",{attrs:{to:"/users/"+t.replyUser.id}},[t._v(t._s(t.replyUser.name))]),t._v("：\n          ")],1)]:t._e(),t._v("\n        "+t._s(t.body)+"\n        "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.bodyLength>60&&!t.isShowAll,expression:"bodyLength > 60 && !isShowAll"}],staticClass:"m-text-more",on:{click:function(e){e.stopPropagation(),t.isShowAll=!t.isShowAll}}},[t._v(" >>更多")])],2)])],1)])},a=[];n("7f7f");function i(t){for(var e,n=0,s=0;s<t.length;s++)e=t.charCodeAt(s),e<127?n+=.25:e>=128&&e<=2047?n+=1:e>=2048&&e<=65535&&(n+=1.5);return n}var o={name:"CommentItem",props:{comment:{type:Object,required:!0},pinned:{type:Boolean,default:!1}},data:function(){return{showAll:!1}},computed:{isShowAll:{get:function(){return this.bodyLength<60||this.showAll},set:function(t){this.showAll=t}},user:function(){var t=this.comment.user;return t&&t.id?t:{}},replyUser:function(){var t=this.comment.reply;return t&&t.id?t:null},body:function(){return this.comment.body||""},bodyLength:function(){return i(this.body)},time:function(){return this.comment.created_at||""}},mounted:function(){this.$store.commit("SAVE_USER",this.user)},methods:{handelClick:function(){if(!this.isShowAll)return this.isShowAll=!this.isShowAll;this.$emit("click",this.user.id,this.user.name,this.comment.id)}}},r=o,c=n("2877"),l=Object(c["a"])(r,s,a,!1,null,null,null);l.options.__file="ArticleComment.vue";e["a"]=l.exports},b567:function(t,e,n){},be53:function(t,e,n){"use strict";var s=n("0980"),a=n.n(s);a.a},c54a:function(t,e,n){"use strict";var s=n("6bb8"),a=n.n(s);a.a},c6f4:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.answer.id?n("article-card",{staticClass:"p-answer-detail",attrs:{liked:t.liked,loading:t.loading},on:{"on-like":t.likeAnswer,"on-share":t.shareAnswer,"on-more":t.moreAction,"on-comment":t.commentAnswer}},[n("common-header",{attrs:{slot:"head"},slot:"head"},[t._v(t._s(t.answer.question.subject))]),n("main",{staticClass:"m-flex-shrink1 m-flex-grow1 m-art m-main"},[n("div",{staticClass:"user-info-wrap"},[n("avatar",{attrs:{anonymity:t.answer.anonymity,user:t.user}}),n("div",{staticClass:"user-info"},[t.isMine||!t.answer.anonymity?n("h2",{staticClass:"m-text-cut"},[t._v(t._s(t.user.name)+" "),t.answer.anonymity?n("span",{staticClass:"gray"},[t._v("(匿名)")]):t._e()]):n("h2",{staticClass:"m-text-cut"},[t._v("匿名用户")]),t.isMine||!t.answer.anonymity?n("p",{staticClass:"m-text-cut"},[t._v(t._s(t.user.bio||"这家伙很懒,什么也没留下"))]):t._e()]),t.isMine||t.answer.anonymity?t._e():[t.user.follower?n("span",{on:{click:function(e){t.followUser(!1)}}},[n("svg",{staticClass:"m-style-svg follow-btn"},[n("use",{attrs:{"xlink:href":"#icon-yes"}})]),t._v("\n          已关注\n        ")]):n("span",{staticClass:"actived",on:{click:function(e){t.followUser(!0)}}},[n("svg",{staticClass:"m-style-svg follow-btn"},[n("use",{attrs:{"xlink:href":"#icon-plus"}})]),t._v("\n          关注\n        ")])]],2),n("div",{staticClass:"m-art-body"},[n("p",{staticClass:"m-text-box markdown-body",domProps:{innerHTML:t._s(t.formatBody(t.content))}})]),n("div",{staticClass:"m-box m-aln-center m-justify-bet m-art-foot"},[n("router-link",{staticClass:"m-flex-grow1 m-flex-shrink1 m-box m-aln-center m-art-like-list",attrs:{tag:"div",to:"likers",append:""}},[n("ul",{staticClass:"m-box m-flex-grow0 m-flex-shrink0 mr10"},t._l(t.likes.slice(0,5),function(e,s){var a=e.user;void 0===a&&(a={});var i=e.id;return n("li",{key:i,staticClass:"m-avatar-box tiny",class:"m-avatar-box-"+a.sex,style:{zIndex:5-s}},[n("img",{attrs:{src:t.getAvatar(a.avatar)}})])})),t.likeCount?n("span",[t._v(t._s(t._f("formatNum")(t.likeCount))+" 人点赞")]):t._e()]),n("div",{staticClass:"m-box-model m-aln-end m-art-info"},[n("span",[t._v("发布于"+t._s(t._f("time2tips")(t.time)))]),n("span",[t._v(t._s(t._f("formatNum")(t.viewsCount))+"浏览")])])],1),n("div",{staticClass:"m-box-model m-box-center m-box-center-a m-art-reward"},[n("button",{staticClass:"m-art-rew-btn",on:{click:t.rewardAnswer}},[t._v("打 赏")]),n("p",{staticClass:"m-art-rew-label"},[n("a",{attrs:{href:"javascript:;"}},[t._v(t._s(t._f("formatNum")(t.reward.count)))]),t._v(" 人打赏，共\n        "),n("a",{attrs:{href:"javascript:;"}},[t._v(t._s(~~t.reward.amount))]),t._v(" "+t._s(t.currencyUnit)+"\n      ")]),n("router-link",{staticClass:"m-box m-aln-center m-art-rew-list",attrs:{tag:"ul",to:"rewarders",append:""}},[t._l(t.rewardList,function(e){return n("li",{key:e.id,staticClass:"m-flex-grow0 m-flex-shrink0 m-art-rew m-avatar-box tiny",class:"m-avatar-box-"+e.user.sex},[n("img",{attrs:{src:t.getAvatar(e.user.avatar)}})])}),t.rewardList.length>0?n("li",{staticClass:"m-box m-aln-center"},[n("svg",{staticClass:"m-style-svg m-svg-def",staticStyle:{fill:"#bfbfbf"}},[n("use",{attrs:{"xlink:href":"#icon-arrow-right"}})])]):t._e()],2)],1)]),n("div",{staticClass:"m-box-model m-art-comments",attrs:{id:"comment_list"}},[n("ul",{staticClass:"m-box m-aln-center m-art-comments-tabs"},[n("li",[t._v(t._s(t._f("formatNum")(t.commentCount))+"条评论")])]),t._l(t.pinnedCom,function(e){return n("comment-item",{key:"pinned-comment-"+e.id,attrs:{pinned:!0,comment:e},on:{click:t.replyComment}})}),t._l(t.comments,function(e){return n("comment-item",{key:e.id,attrs:{comment:e},on:{click:t.replyComment}})}),n("div",{staticClass:"m-box m-aln-center m-justify-center load-more-box"},[t.noMoreCom?n("span",{staticClass:"load-more-ph"},[t._v("---没有更多---")]):n("span",{staticClass:"load-more-btn",on:{click:function(e){e.stopPropagation(),t.fetchAnswerComments(t.maxComId)}}},[t._v("\n        "+t._s(t.fetchComing?"加载中...":"点击加载更多")+"\n      ")])])],2)],1):t._e()},a=[],i=n("8afe"),o=n("c93e"),r=n("2ef0"),c=n.n(r),l=n("2f62"),u=n("d4cd"),d=n.n(u),h=n("2ae9"),f=n.n(h),m=n("607e"),v=n("ae61"),p=n("365c"),w=n("cac4"),_=n("c24f"),b={name:"AnswerDetail",components:{ArticleCard:m["a"],CommentItem:v["a"]},data:function(){return{loading:!1,fetching:!1,answer:{},comments:[],pinnedCom:[],rewardList:[],reward:{count:0,amount:0},fetchComing:!1,fetchFollow:!1,noMoreCom:!1,maxComId:0}},computed:Object(o["a"])({},Object(l["d"])(["CURRENTUSER"]),{questionId:function(){return this.$route.params.questionId},answerId:function(){return this.$route.params.answerId},user:function(){return this.answer.user||{}},time:function(){return this.answer.created_at||""},liked:{get:function(){return!!this.answer.liked},set:function(t){this.answer.liked=t}},likes:function(){return this.answer.likes||[]},collected:{get:function(){return this.answer.collected},set:function(t){this.answer.collected=t}},likeCount:{get:function(){return this.answer.likes_count||0},set:function(t){this.answer.likes_count=~~t}},viewsCount:function(){return this.answer.views_count||0},commentCount:{get:function(){return this.answer.comments_count||0},set:function(t){this.answer.comments_count=~~t}},content:function(){var t=this.answer.body,e=void 0===t?"":t;return e},isMine:function(){return this.user.id===this.CURRENTUSER.id},isWechat:function(){return this.$store.state.BROWSER.isWechat}}),created:function(){this.fetchAnswer()},methods:{getAvatar:function(t){return t=t||{},t.url||null},formatBody:function(t){return d()({html:!0}).use(f.a,"".concat(this.$http.defaults.baseURL,"/files/")).render(t)},likeAnswer:function(){var t=this;this.fetching||(this.fetching=!0,this.liked?w["l"](this.answerId).then(function(){t.liked=!1,t.likeCount-=1,t.answer.likes=t.answer.likes.filter(function(e){return e.user_id!==t.CURRENTUSER.id})}).finally(function(){t.fetching=!1}):w["f"](this.answerId).then(function(){t.liked=!0,t.likeCount+=1,t.answer.likes.length<5&&t.answer.likes.push({user:t.CURRENTUSER,id:+new Date,user_id:t.CURRENTUSER.id})}).finally(function(){t.fetching=!1}))},shareAnswer:function(){this.isWechat?this.$Message.success("请点击右上角微信分享😳"):this.$Message.success("请使用浏览器的分享功能😳")},commentAnswer:function(){var t=this;this.$bus.$emit("commentInput",{onOk:function(e){t.sendComment({body:e})}})},rewardAnswer:function(){var t=this,e=function(e){t.fetchRewards(),t.reward.count+=1,t.reward.amount+=e};this.$bus.$emit("reward",{type:"answer",api:w["j"],payload:this.answerId,callback:e})},moreAction:function(){var t=this,e=[];this.collected?e.push({text:"取消收藏",method:function(){w["k"](t.answerId).then(function(){t.collected=!1,t.$Message.success("取消收藏")})}}):e.push({text:"收藏",method:function(){w["a"](t.answerId).then(function(){t.collected=!0,t.$Message.success("收藏成功")})}}),this.$bus.$emit("actionSheet",e)},fetchRewards:function(){var t=this;w["e"](this.answerId,{limit:10}).then(function(e){var n=e.data;t.rewardList=n})},fetchAnswer:function(){var t=this;this.loading||(this.loading=!0,w["c"](this.answerId).then(function(e){var n=e.data;t.answer=n,t.reward.count=n.rewarder_count,t.reward.amount=n.rewards_amount,t.rewardList=n.rewarders,t.fetchAnswerComments(),t.loading=!1}))},fetchAnswerComments:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.fetchComing||(this.fetchComing=!0,w["d"](this.answerId,{limit:p["b"],after:e}).then(function(n){var s=n.data,a=void 0===s?[]:s;a&&a.length&&(t.comments=e?Object(i["a"])(t.comments).concat(Object(i["a"])(a)):a,t.maxComId=a[a.length-1].id),t.noMoreCom=a.length<15}).finally(function(){t.$nextTick(function(){t.fetchComing=!1,t.loading=!1})}))},replyComment:function(t,e,n){var s=this;t===this.CURRENTUSER.id?this.$bus.$emit("actionSheet",[{text:"删除评论",method:function(){s.deleteAnswerComment(n)}}],"取消"):this.$bus.$emit("commentInput",{placeholder:"回复： ".concat(e),onOk:function(e){s.sendComment({reply_user:t,body:e})}})},sendComment:function(t){var e=this,n=t.reply_user,s=t.body,a={};s&&s.length>0?(a.body=s,n&&(a["reply_user"]=n),this.$http.post("/question-answers/".concat(this.answerId,"/comments"),a,{validateStatus:function(t){return 201===t}}).then(function(t){var n=t.data;n=void 0===n?{comment:{}}:n;var s=n.comment;e.$Message.success("评论成功"),e.comments.unshift(s),e.commentCount+=1,e.$bus.$emit("commentInput:close",!0)}).catch(function(){e.$Message.error("评论失败"),e.$bus.$emit("commentInput:close",!0)})):this.$Message.error("评论内容不能为空")},deleteAnswerComment:function(t){var e=this;w["b"](this.answerId,t).then(function(){e.$Message.success("删除评论成功"),c.a.remove(e.comments,function(e){return e.id===t}),e.commentCount-=1,e.$bus.$emit("commentInput:close",!0)})},followUser:function(t){var e=this;this.fetchFollow||(this.fetchFollow=!0,t=t?"unFollow":"follow",_["d"]({id:this.user.id,status:t}).then(function(){e.fetchFollow=!1,e.user.follower=!e.user.follower}))}}},y=b,g=(n("0ea7"),n("2877")),C=Object(g["a"])(y,s,a,!1,null,"e8fee376",null);C.options.__file="AnswerDetail.vue";e["default"]=C.exports},cb07:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"p-question-list"},[n("nav",{staticClass:"nav"},[n("router-link",{attrs:{to:"/question",replace:"",exact:"","exact-active-class":"active"}},[t._v("热门")]),n("router-link",{attrs:{to:t.navRouterLinkBuilder("excellent"),replace:"",exact:"","exact-active-class":"active"}},[t._v("精选")]),n("router-link",{attrs:{to:t.navRouterLinkBuilder("reward"),replace:"",exact:"","exact-active-class":"active"}},[t._v("悬赏")]),n("router-link",{attrs:{to:t.navRouterLinkBuilder("new"),replace:"",exact:"","exact-active-class":"active"}},[t._v("最新")]),n("router-link",{attrs:{to:t.navRouterLinkBuilder("all"),replace:"",exact:"","exact-active-class":"active"}},[t._v("全部")])],1),n("main",{staticClass:"main"},[t.loading?n("div",{staticClass:"main-loading"},[n("icon-loading",{staticClass:"main-loading_icon"})],1):t._e(),t._l(t.questions,function(e){return n("question-card",{key:e.id,attrs:{question:e,"no-excellent":"excellent"===t.type}})}),t.questions.length&&!t.loadmore?n("div",{staticClass:"main-loadmore"},[n("button",{staticClass:"main-loadmore_button",on:{click:t.fetchQuestionsMore}},[t._v("加载更多")])]):t.loadmore?n("div",{staticClass:"main-loadmore"},[n("button",{staticClass:"main-loadmore_button active"},[n("icon-loading",{staticClass:"main-loading_icon"})],1)]):t._e()],2),n("button",{staticClass:"create-question",on:{click:function(e){t.$router.push({name:"postQuestion"})}}},[n("svg",{staticClass:"m-style-svg m-svg-small"},[n("use",{attrs:{"xlink:href":"#icon-plus"}})])])])},a=[],i=n("8afe"),o=n("720b"),r=n.n(o),c=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",t._b({attrs:{width:"120",height:"30",viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg"}},"svg",t.$props,!1),[n("circle",{attrs:{cx:"15",cy:"15",r:"15"}},[n("animate",{attrs:{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}}),n("animate",{attrs:{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}})]),n("circle",{attrs:{cx:"60",cy:"15",r:"9","fill-opacity":"0.3"}},[n("animate",{attrs:{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}}),n("animate",{attrs:{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"}})]),n("circle",{attrs:{cx:"105",cy:"15",r:"15"}},[n("animate",{attrs:{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}}),n("animate",{attrs:{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}})])])},l=[],u={name:"LinearLoading"},d=u,h=n("2877"),f=Object(h["a"])(d,c,l,!1,null,null,null);f.options.__file="LinearLoading.vue";var m=f.exports,v=n("3fda"),p=n("d728"),w={name:"QuestionList",components:{QuestionCard:v["a"],IconLoading:m},data:function(){return{questions:[],loading:!1,loadmore:!1}},computed:{type:function(){var t=this.$route.query.type,e=void 0===t?"hot":t;return e}},watch:{$route:function(t,e){(t.path===e.path&&t.query.type!==e.query.type||!e.query.type)&&this.fetchQuestions()}},mounted:function(){this.fetchQuestions()},methods:{navRouterLinkBuilder:function(t){return{path:"/question",query:{type:t}}},fetchQuestions:function(){var t=this;this.loading=!0,this.questions=[],Object(p["a"])(this.type).then(function(e){var n=e.data;t.questions=n,t.loading=!1}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.loading=!1,t.$Message.error(r()(s,"加载失败，请刷新重试！"))})},fetchQuestionsMore:function(){var t=this;this.loadmore=!0,Object(p["a"])(this.type,this.questions.length+1).then(function(e){var n=e.data;t.loadmore=!1,n.length?t.questions=Object(i["a"])(t.questions).concat(Object(i["a"])(n)):t.$Message.error("没有更多数据了")}).catch(function(e){var n=e.response;n=void 0===n?{}:n;var s=n.data;t.loadmore=!1,t.$Message.error(r()(s,"加载失败，请刷新重试！"))})}}},_=w,b=(n("fb8a"),Object(h["a"])(_,s,a,!1,null,"f88abd80",null));b.options.__file="QuestionList.vue";e["default"]=b.exports},d73d:function(t,e,n){},dc6d:function(t,e,n){"use strict";var s=n("f58c"),a=n.n(s);a.a},dcef:function(t,e,n){"use strict";var s=n("a52a"),a=n.n(s);a.a},dd6a:function(t,e,n){"use strict";var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"topic-card"},[n("router-link",{staticClass:"topic-image",attrs:{src:t.avatar,to:"/question-topics/"+t.topic.id,tag:"img"}}),n("router-link",{staticClass:"title",attrs:{to:"/question-topics/"+t.topic.id,tag:"a"}},[n("div",{staticClass:"topic m-text-cut"},[t._v(t._s(t.topic.name))]),n("div",{staticClass:"label"},[n("span",[t._v(t._s(t.topic.follows_count))]),t._v(" 关注\n      ·\n      "),n("span",[t._v(t._s(t.topic.questions_count))]),t._v(" 问题\n    ")])]),t.topic.has_follow||"follow"===t.type?n("button",{staticClass:"follow active",on:{click:function(e){t.handleUnfollow(t.topic)}}},[n("svg",{staticClass:"m-style-svg m-svg-small"},[n("use",{attrs:{"xlink:href":"#icon-yes"}})]),t._v("\n    已关注\n  ")]):n("button",{staticClass:"follow",on:{click:function(e){t.handleFollow(t.topic)}}},[n("svg",{staticClass:"m-style-svg m-svg-small"},[n("use",{attrs:{"xlink:href":"#icon-plus"}})]),t._v("\n    关注\n  ")])],1)},a=[],i={name:"TopicCard",props:{topic:{type:Object,required:!0},type:{type:String,default:"hot"}},computed:{avatar:function(){var t=this.topic.avatar||{};return t.url||null}},methods:{handleUnfollow:function(t){this.$emit("unfollow",t)},handleFollow:function(t){this.$emit("follow",t)}}},o=i,r=(n("2840"),n("2877")),c=Object(r["a"])(o,s,a,!1,null,"f9ec2cae",null);c.options.__file="TopicCard.vue";e["a"]=c.exports},e2eb:function(t,e,n){},f0a8:function(t,e,n){"use strict";var s=n("e2eb"),a=n.n(s);a.a},f58c:function(t,e,n){},f881:function(t,e,n){},fb8a:function(t,e,n){"use strict";var s=n("6a6b"),a=n.n(s);a.a}}]);
//# sourceMappingURL=question-92aba9c922b3391b57d6.js.map